import{c as L}from"./cartStore-jFurpRHJ.js";import{J as $,K as C,m as _,a as I,_ as m,o as n,c as a,L as b,M as A,b as t,F as f,I as P,t as d,r as h,d as g,O as E}from"./index-_YCGk4ob.js";import{s as T}from"./sweetalert2.all-KFTXVkhv.js";import{p as k}from"./paginationComponent-zI6m3mnd.js";var S={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"annchou",BASE_URL:"/vue_week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:V,VITE_PATH:x}=S,p=$("allProductsStore",{state:()=>({allProducts:[],categoryList:[]}),actions:{getAllProducts(){const o=`${V}/api/${x}/products/all`;C.get(o).then(e=>{this.allProducts=e.data.products,this.getCategoryList()}).catch(e=>{T.fire({icon:"error",text:e.response.data.message})})},getCategoryList(){const o=new Set(this.allProducts.map(e=>e.category));this.categoryList=[...o]}}}),w={data(){return{currentCategory:""}},watch:{currentCategory(){this.$emit("getProductList",1,this.currentCategory)}},methods:{..._(p,["getAllProducts"])},computed:{...I(p,["allProducts","categoryList"])}},D=t("label",{for:"category",class:"me-3"},"產品分類篩選",-1),R=t("option",{value:""},"全部",-1),B=["value"];function H(o,e,u,l,r,c){return n(),a("div",null,[D,b(t("select",{name:"category",id:"category","onUpdate:modelValue":e[0]||(e[0]=i=>r.currentCategory=i)},[R,(n(!0),a(f,null,P(o.categoryList,i=>(n(),a("option",{value:i,key:i},d(i),9,B))),128))],512),[[A,r.currentCategory]])])}const O=m(w,[["render",H]]);var U={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"annchou",BASE_URL:"/vue_week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:G,VITE_PATH:M}=U,z={data(){return{productsList:[],pagination:{}}},methods:{..._(L,["addToCart"]),..._(p,["getAllProducts"]),getProductList(o=1,e){let u=`${G}/api/${M}/products?page=${o}`;e&&(u+=`&category=${e}`),this.axios.get(u).then(l=>{const{products:r,pagination:c}=l.data;this.productsList=r,this.pagination=c}).catch(l=>{this.$swal.fire({icon:"error",text:l.response.data.message})})},showProductInfo(o){this.$router.push(`/productinfo/${o}`)}},mounted(){this.getProductList(),this.getAllProducts()},components:{paginationComponent:k,filterCategory:O}},F={class:"container"},N=t("h2",{class:"py-5 h2 text-center"},"看產品",-1),J={class:"table align-middle"},K=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),j={style:{width:"200px"}},q={key:0,class:"h5"},Q={key:1},W={class:"h6"},X={class:"h5"},Y={class:"btn-group btn-group-sm"},Z=["onClick"],tt=["onClick"];function et(o,e,u,l,r,c){const i=h("filterCategory"),y=h("paginationComponent");return n(),a("div",F,[N,g(i,{onGetProductList:c.getProductList},null,8,["onGetProductList"]),t("table",J,[K,t("tbody",null,[(n(!0),a(f,null,P(r.productsList,s=>(n(),a("tr",{key:s.id},[t("td",j,[t("div",{style:E([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.imageUrl})`}])},null,4)]),t("td",null,d(s.title),1),t("td",null,[s.price?(n(),a("div",Q,[t("del",W,"原價 "+d(s.origin_price)+" 元",1),t("div",X,"現在只要 "+d(s.price)+" 元",1)])):(n(),a("div",q,d(s.origin_price)+" 元",1))]),t("td",null,[t("div",Y,[t("button",{type:"button",class:"btn btn-outline-default",onClick:v=>c.showProductInfo(s.id)}," 查看更多 ",8,Z),t("button",{type:"button",class:"btn btn-default",onClick:v=>o.addToCart(s.id,1)}," 加到購物車 ",8,tt)])])]))),128))])]),g(y,{pagination:r.pagination,onGetList:c.getProductList},null,8,["pagination","onGetList"])])}const rt=m(z,[["render",et]]);export{rt as default};
